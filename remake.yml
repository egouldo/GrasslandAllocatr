packages:
  - magrittr
  - dplyr
  - GrasslandAllocatr
  - RNetica

sources:
  - remake/utils/remake_functions_utils.R
  - remake/utils/field_data_2010_2011_reshape.R

targets:
  all:
    depends:
      - build_field_data
#      - load_learn_process_model

  build_field_data:
    depends:
      - field_data_by_quadrat_2014
      - field_data_by_transect_2014
      - field_data_by_mu_2014
      - casefile_df_2014
      - processed_data/casefile_2014.cas
      - field_data_by_mu_2010_2011
      - casefile_df_2010_2011
      - processed_data/casefile_2010_2011.cas


#  load_learn_process_model:
#    depends: processed_data/grassland_bbn_learned_1.dne # Paul Rees' data (no fire) -
      #- grassland_bbn_learned_2 # My 2014 data (snapshot, but with fire)
      #- grassland_bbn_learned_3 # 2015 data (Fiona Coates' data)
      #- processed_data/grassland_bbn_learned_1.dne
      #- processed_data/grassland_bbn_learned_2.dne

  #----------------- Build and Summarise Field Data ----------

  field_data_by_quadrat_2014:
    command: build_raw_dataset(raw_field_data = "./data-raw/field_data_raw_2014.csv",
                  species_lookup_data = "./data-raw/field_species_lookup_table_2014.csv",
                  management_lookup_data = "./data-raw/field_site_management_2014.csv")

  field_data_by_transect_2014:
    command: summarise_by_transect(field_data_by_quadrat_2014)

  field_data_by_mu_2014:
    command: summarise_by_mu(field_data_by_transect = field_data_by_transect_2014, year = 1)

  casefile_df_2014:
    command: generate_case_file_df(field_data_by_mu = field_data_by_mu_2014)

  processed_data/casefile_2014.cas:
    command:  write.CaseFile(casefile_df_2014, file = 'processed_data/casefile_2014.cas')

  field_data_by_mu_2010_2011:
    command: reshape_pauls_data_all_years(file_path = "./data-raw/field_data_by_transect_2010_2011.csv")

  casefile_df_2010_2011:
    command:  generate_case_file_df(field_data_by_mu = field_data_by_mu_2010_2011)

  processed_data/casefile_2010_2011.cas:
    command: write.CaseFile(casefile_df_2010_2011, file = 'processed_data/casefile_2010_2011.cas')

  # ---------------- Write Rda objects for export in pkg -------

  #devtools::use_data(field_data_by_transect_2014,field_data_by_mu_2014, casefile_df_2014, field_data_by_mu_2010_2011, casefile_df_2010_2011, overwrite = TRUE)

  # ---------------- Load and Learn Process Model --------------

  #processed_data/grassland_bbn_learned_1.dne:
    #command: learn_grassland_bbn(path = "./data/grassland_bbn_no_learning.dne", casefile_path = "processed_data/casefile_2010_2011.cas",first_iteration = TRUE, save_path = "processed_data/grassland_bbn_learned_1.dne")

  #processed_data/grassland_bbn_learned_2.dne:
    #command: learn_grassland_bbn(path = "processed_data/grassland_bbn_learned_1.dne", casefile_path = "processed_data/casefile_2014.cas",first_iteration = FALSE, save_path = "processed_data/grassland_bbn_learned_2.dne")


  # ----------- Decision Modelling with Hypothetical Sites -------












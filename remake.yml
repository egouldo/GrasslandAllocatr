packages:
  - GrasslandAllocatr
  - RNetica

sources:
  - R/load_compile_grassland_bbn.R

targets:
  all:
    depends:
      - build_field_data
      - load_learn_process_model

  build_field_data:
    depends:
      - 2014_field_data_by_quadrat
      - 2014_field_data_by_transect
      - 2014_field_data_by_mu
      - processed_data/2014_casefile.cas

  load_learn_process_model:
    depends:
      - grassland_bbn # No Learning
      #- process_model_learning_1 # Paul Rees' data (no fire) -
      #- process_model_learning_2 # My 2014 data (snapshot, but with fire)
      #- process_model_learning_3 # 2015 data (Fiona Coates' data)

  #----------------- Build and Summarise Field Data ----------

  2014_field_data_by_quadrat:
    command: build_raw_dataset(raw_field_data = "./data/field_data_raw_2014.csv",
                  species_lookup_data = "./data/field_species_lookup_table_2014.csv",
                  management_lookup_data = "./data/field_site_management_2014.csv")

  2014_field_data_by_transect:
    command: summarise_by_transect(`2014_field_data_by_quadrat`)

  2014_field_data_by_mu:
    command: generate_case_file_data_frame(field_data_by_transect = `2014_field_data_by_transect`, year = 1)

  processed_data/2014_casefile.cas:
    command: write.CaseFile(`2014_field_data_by_mu`, file = 'processed_data/2014_casefile.cas')

  #---------------- Load and Learn Process Model --------------

  grassland_bbn: # load and compile process model with no learning
    command: load_compile_grassland_bbn("./data/grassland_bbn_no_learning.dne")

  #process_model_learning_1: # learn with Paul's 2010 - 2011 data
    #command:

  #process_model_learning_2: # learn with "2014_casefile.cas"
    #command:

  #process_model_learning_3: # learn with "2015_casefile.cas"
    #command:
